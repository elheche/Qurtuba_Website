<div class="registration-container">
  <mat-toolbar color="primary" [class.mat-elevation-z4]="true">
    <a mat-icon-button matTooltip="Home" href="http://localhost:4200">
      <mat-icon>home</mat-icon>
    </a>
    <a mat-icon-button matTooltip="Login" href="http://localhost:4200/login">
      <mat-icon>login</mat-icon>
    </a>
  </mat-toolbar>
  <mat-card class="registration-form-container" #registrationFormContainer>
    <mat-card-header>
      <mat-card-title>Open an account</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-horizontal-stepper linear="false" #stepper>
        <!-- Step 1 -->
        <mat-step [stepControl]="registrationFormStep1" [editable]="isEditable">
          <form [formGroup]="registrationFormStep1" id="registration-form-step-1">
            <ng-template matStepLabel>Step 1</ng-template>
            <h2>Create your login</h2>
            <mat-form-field appearance="outline">
              <mat-label>Enter your email</mat-label>
              <input matInput type="email" placeholder="user@example.com" formControlName="email" required>
              <mat-error *ngIf="registrationFormStep1.get('email').invalid">
                {{getErrorMessage('registrationFormStep1', 'email')}}
              </mat-error>
              <button mat-icon-button matPrefix disabled>
                <mat-icon>email</mat-icon>
              </button>
            </mat-form-field>
            <mat-form-field appearance="outline"
              hintLabel="Your password must contain at least 8 characters with at least 1 numeric character, 1 uppercase letter, 1 lowercase letter and 1 special character.">
              <mat-label>Enter your password</mat-label>
              <input matInput [type]="hide ? 'password' : 'text'" formControlName="password" required
                (input)="onPasswordValueChange()" #passwordInput maxlength="32">
              <mat-hint align="end">{{passwordInput.value?.length || 0}}/32</mat-hint>
              <mat-error *ngIf="registrationFormStep1.get('password').invalid">
                {{getErrorMessage('registrationFormStep1', 'password')}}
              </mat-error>
              <button mat-icon-button matPrefix disabled>
                <mat-icon>lock</mat-icon>
              </button>
              <button type="button" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'"
                [attr.aria-pressed]="hide">
                <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Confirm your password</mat-label>
              <input matInput [type]="hide ? 'password' : 'text'" formControlName="confirmPassword" required>
              <mat-error *ngIf="registrationFormStep1.get('confirmPassword').invalid">
                {{getErrorMessage('registrationFormStep1', 'confirmPassword')}}</mat-error>
              <button mat-icon-button matPrefix disabled>
                <mat-icon>lock</mat-icon>
              </button>
              <button type="button" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'"
                [attr.aria-pressed]="hide">
                <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
            </mat-form-field>
            <div class="stepper-navigation-button-container">
              <button class="stepper-navigation-button" mat-raised-button color="primary" matStepperNext
                [disabled]="registrationFormStep1.invalid">Next</button>
            </div>
          </form>
        </mat-step>
        <!-- Step 2 -->
        <mat-step [stepControl]="registrationFormStep2" [editable]="isEditable">
          <form [formGroup]="registrationFormStep2" id="registration-form-step-2">
            <ng-template matStepLabel>Step 2</ng-template>
            <h2>Fill your membership application</h2>
            <div id="membership-type-container">
              <label id="membership-type-label">Indicate the type of membership</label>
              <mat-radio-group aria-labelledby="membership-type-label" class="membership-type"
                formControlName="membershipType" required>
                <mat-radio-button class="membership-type-radio-button"
                  *ngFor="let membershipType of environment.registration.membershipTypes" [value]="membershipType">
                  {{membershipType}}
                </mat-radio-button>
              </mat-radio-group>
              <mat-error *ngIf="registrationFormStep2.get('membershipType').invalid">
                {{getErrorMessage('registrationFormStep2', 'membershipType')}}
              </mat-error>
            </div>
            <div id="account-type-container">
              <label id="account-type-label">Indicate the type of account</label>
              <mat-radio-group aria-labelledby="account-type-label" class="account-type" formControlName="accountType"
                required>
                <mat-radio-button class="account-type-radio-button"
                  *ngFor="let accountType of environment.registration.accountTypes" [value]="accountType">
                  {{accountType}}
                </mat-radio-button>
              </mat-radio-group>
              <mat-error *ngIf="registrationFormStep2.get('accountType').invalid">
                {{getErrorMessage('registrationFormStep2', 'accountType')}}
              </mat-error>
            </div>
            <mat-form-field appearance="outline">
              <mat-label>First name</mat-label>
              <input matInput formControlName="firstName" required>
              <mat-error *ngIf="registrationFormStep2.get('firstName').invalid">
                {{getErrorMessage('registrationFormStep2', 'firstName')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Last name</mat-label>
              <input matInput formControlName="lastName" required>
              <mat-error *ngIf="registrationFormStep2.get('lastName').invalid">
                {{getErrorMessage('registrationFormStep2', 'lastName')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Birth day</mat-label>
              <input matInput type="date" formControlName="birthDay" required
                [min]="environment.registration.birthDateRange.minDate"
                [max]="environment.registration.birthDateRange.maxDate">
              <mat-error *ngIf="registrationFormStep2.get('birthDay').invalid">
                {{getErrorMessage('registrationFormStep2', 'birthDay')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Phone number</mat-label>
              <input matInput type="tel" formControlName="phoneNumber" maxlength="14" required
                (input)="formatPhoneNumber($event)" placeholder="(555) 555-1234">
              <mat-error *ngIf="registrationFormStep2.get('phoneNumber').invalid">
                {{getErrorMessage('registrationFormStep2', 'phoneNumber')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Address</mat-label>
              <input matInput formControlName="address" required placeholder="Ex. 123 Main St Apt 10"
                [value]="registrationFormStep2.get('address').value | titlecase">
              <mat-error *ngIf="registrationFormStep2.get('address').invalid">
                {{getErrorMessage('registrationFormStep2', 'address')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>City</mat-label>
              <input matInput formControlName="city" required placeholder="Ex. Montreal"
                [value]="registrationFormStep2.get('city').value | titlecase">
              <mat-error *ngIf="registrationFormStep2.get('city').invalid">
                {{getErrorMessage('registrationFormStep2', 'city')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Country</mat-label>
              <mat-select formControlName="country" required (selectionChange)="onCountryValueChange()">
                <mat-option>--</mat-option>
                <mat-option *ngFor="let country of countries" [value]="country.countryName">
                  <mat-icon svgIcon="{{'flag-'.concat(country.countryShortCode.toLowerCase())}}"></mat-icon>
                  {{country.countryName}}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="registrationFormStep2.get('country').invalid">
                {{getErrorMessage('registrationFormStep2', 'country')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>State/Province/Region</mat-label>
              <mat-select formControlName="province" required>
                <mat-option>--</mat-option>
                <mat-option
                  *ngFor="let province of countries[findSelectedCountryIndex()]? countries[findSelectedCountryIndex()].regions: []"
                  [value]="province.name">
                  {{province.name}} ({{province.shortCode}})
                </mat-option>
              </mat-select>
              <mat-error *ngIf="registrationFormStep2.get('province').invalid">
                {{getErrorMessage('registrationFormStep2', 'province')}}
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Zip/Postal code</mat-label>
              <input matInput formControlName="postalCode" maxlength="14" required
                [value]="registrationFormStep2.get('postalCode').value | uppercase" (input)="formatCanadianPostalCode($event)"
                placeholder="Ex. J4K 5G7">
              <mat-error *ngIf="registrationFormStep2.get('postalCode').invalid">
                {{getErrorMessage('registrationFormStep2', 'postalCode')}}
              </mat-error>
            </mat-form-field>
            <div class="stepper-navigation-button-container">
              <button class="stepper-navigation-button" mat-raised-button color="primary"
                matStepperPrevious>Back</button>
              <button class="stepper-navigation-button" mat-raised-button color="primary" matStepperNext>Next</button>
            </div>
          </form>
        </mat-step>
        <!-- Step 3 -->
        <mat-step [stepControl]="registrationFormStep3" [editable]="isEditable">
          <form [formGroup]="registrationFormStep3" id="registration-form-step-3">
            <ng-template matStepLabel>Step 3</ng-template>
            <h2>Fill your membership application (continued)</h2>
            <mat-form-field appearance="outline">
              <mat-label>Social Insurance Number</mat-label>
              <input matInput formControlName="socialInsuranceNumber" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Citizenship</mat-label>
              <input matInput formControlName="citizenship" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Profession</mat-label>
              <input matInput formControlName="profession" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Employer</mat-label>
              <input matInput formControlName="employer" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Employer phone number</mat-label>
              <input matInput formControlName="employerPhoneNumber" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Number of dependents</mat-label>
              <input matInput formControlName="numberOfDependents" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Deposit amount</mat-label>
              <input matInput formControlName="depositAmount" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Membership Fee</mat-label>
              <input matInput formControlName="membershipFee" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Donation for mosque</mat-label>
              <input matInput formControlName="donationForMosque" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Total amount</mat-label>
              <input matInput formControlName="totalAmount" required>
            </mat-form-field>
            <div class="stepper-navigation-button-container">
              <button class="stepper-navigation-button" mat-raised-button color="primary"
                matStepperPrevious>Back</button>
              <button class="stepper-navigation-button" mat-raised-button color="primary" matStepperNext>Next</button>
            </div>
          </form>
        </mat-step>
        <!-- Step 4 -->
        <mat-step [stepControl]="registrationFormStep4" [editable]="isEditable">
          <form [formGroup]="registrationFormStep4" id="registration-form-step-4">
            <ng-template matStepLabel>Step 4</ng-template>
            <h2>Fill the application form for the joint member</h2>
            <mat-form-field appearance="outline">
              <mat-label>First name</mat-label>
              <input matInput formControlName="firstName" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Last name</mat-label>
              <input matInput formControlName="lastName" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Address</mat-label>
              <input matInput formControlName="address" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>City</mat-label>
              <input matInput formControlName="city" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Province</mat-label>
              <input matInput formControlName="province" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Postal code</mat-label>
              <input matInput formControlName="postalCode" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Social Insurance Number</mat-label>
              <input matInput formControlName="socialInsuranceNumber" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Citizenship</mat-label>
              <input matInput formControlName="citizenship" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Profession</mat-label>
              <input matInput formControlName="profession" required>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Relationship</mat-label>
              <input matInput formControlName="relationship" required>
            </mat-form-field>
            <div class="stepper-navigation-button-container">
              <button class="stepper-navigation-button" mat-raised-button color="primary"
                matStepperPrevious>Back</button>
              <button class="stepper-navigation-button" mat-raised-button color="primary" matStepperNext>Next</button>
            </div>
          </form>
        </mat-step>
        <!-- Step 5 -->
        <mat-step>
          <ng-template matStepLabel>Done</ng-template>
          <h2>Please review the information you have entered</h2>
          <mat-checkbox color="primary">
            I / We have read the Regulations and By-laws of the "Co-operative" and I / We fully agree to abide by them.
          </mat-checkbox>
          <div class="stepper-navigation-button-container">
            <button class="stepper-navigation-button" mat-raised-button color="primary" matStepperPrevious>Back</button>
            <button class="stepper-navigation-button" mat-raised-button color="primary"
              (click)="stepper.reset()">Reset</button>
          </div>
        </mat-step>
      </mat-horizontal-stepper>
    </mat-card-content>
  </mat-card>
</div>
